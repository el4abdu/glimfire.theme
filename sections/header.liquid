<header class="site-header" data-sticky-header>
  <div class="header-container">
    <div class="header-left">
      <button class="mobile-menu-toggle" aria-label="Menu" aria-controls="mobile-menu" aria-expanded="false">
        <span class="hamburger-icon"></span>
      </button>
      
      <div class="header-logo">
        {% if section.settings.logo != blank %}
          <a href="/" class="logo-link">
            <img src="{{ section.settings.logo | img_url: '180x' }}" alt="{{ shop.name }}" class="logo-image">
          </a>
        {% else %}
          <a href="/" class="logo-link site-name">{{ shop.name }}</a>
        {% endif %}
      </div>
    </div>
    
    <nav class="header-nav">
      <ul class="nav-menu">
        {% for link in section.settings.menu.links %}
          {% assign submenu = false %}
          {% if link.links.size > 0 %}
            {% assign submenu = true %}
          {% endif %}
          
          <li class="nav-item{% if submenu %} has-dropdown{% endif %}">
            <a href="{{ link.url }}" class="nav-link{% if link.active %} active{% endif %}">
              <span>{{ link.title }}</span>
              {% if submenu %}
                <svg class="dropdown-arrow" width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              {% endif %}
            </a>
            
            {% if submenu %}
              <div class="dropdown-menu">
                <div class="dropdown-container">
                  <ul class="dropdown-list">
                    {% for childlink in link.links %}
                      <li class="dropdown-item">
                        <a href="{{ childlink.url }}" class="dropdown-link{% if childlink.active %} active{% endif %}">
                          {{ childlink.title }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </nav>
    
    <div class="header-right">
      <div class="header-actions">
        <button class="search-toggle" aria-label="Search" aria-controls="search-modal" aria-expanded="false">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <a href="/account" class="account-link" aria-label="Account">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16.6667 17.5V15.8333C16.6667 14.9493 16.3155 14.1014 15.6904 13.4763C15.0653 12.8512 14.2174 12.5 13.3334 12.5H6.66671C5.78265 12.5 4.93481 12.8512 4.30968 13.4763C3.68456 14.1014 3.33337 14.9493 3.33337 15.8333V17.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M10 9.16667C11.841 9.16667 13.3334 7.67428 13.3334 5.83333C13.3334 3.99238 11.841 2.5 10 2.5C8.15907 2.5 6.66669 3.99238 6.66669 5.83333C6.66669 7.67428 8.15907 9.16667 10 9.16667Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        
        <a href="/cart" class="cart-link" aria-label="Cart">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.5 18.3333C7.96024 18.3333 8.33333 17.9602 8.33333 17.5C8.33333 17.0398 7.96024 16.6667 7.5 16.6667C7.03976 16.6667 6.66667 17.0398 6.66667 17.5C6.66667 17.9602 7.03976 18.3333 7.5 18.3333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M16.6667 18.3333C17.1269 18.3333 17.5 17.9602 17.5 17.5C17.5 17.0398 17.1269 16.6667 16.6667 16.6667C16.2064 16.6667 15.8333 17.0398 15.8333 17.5C15.8333 17.9602 16.2064 18.3333 16.6667 18.3333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M0.833374 0.833344H4.16671L6.40004 11.9917C6.47629 12.3753 6.68496 12.72 6.98966 12.9653C7.29436 13.2105 7.67592 13.3408 8.06671 13.3333H16.1667C16.5575 13.3408 16.9391 13.2105 17.2438 12.9653C17.5485 12.72 17.7571 12.3753 17.8334 11.9917L19.1667 5.00001H5.00004" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="cart-count">{{ cart.item_count }}</span>
        </a>
      </div>
    </div>
  </div>
  
  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobile-menu" aria-hidden="true">
    <div class="mobile-menu-container">
      <div class="mobile-menu-header">
        <button class="mobile-menu-close" aria-label="Close menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      
      <nav class="mobile-menu-nav">
        <ul class="mobile-menu-list">
          {% for link in section.settings.menu.links %}
            {% assign has_submenu = false %}
            {% if link.links.size > 0 %}
              {% assign has_submenu = true %}
            {% endif %}
            
            <li class="mobile-menu-item{% if has_submenu %} has-submenu{% endif %}">
              {% if has_submenu %}
                <button class="mobile-menu-trigger">
                  <span>{{ link.title }}</span>
                  <svg class="mobile-menu-arrow" width="12" height="7" viewBox="0 0 12 7" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                
                <ul class="mobile-submenu">
                  {% for childlink in link.links %}
                    <li class="mobile-submenu-item">
                      <a href="{{ childlink.url }}" class="mobile-submenu-link{% if childlink.active %} active{% endif %}">
                        {{ childlink.title }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              {% else %}
                <a href="{{ link.url }}" class="mobile-menu-link{% if link.active %} active{% endif %}">
                  {{ link.title }}
                </a>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </nav>
    </div>
  </div>
  
  <!-- Search Modal -->
  <div class="search-modal" id="search-modal" aria-hidden="true">
    <div class="search-modal-container">
      <div class="search-modal-header">
        <h3 class="search-modal-title">Search</h3>
        <button class="search-modal-close" aria-label="Close search">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      
      <form action="/search" method="get" class="search-form">
        <div class="search-input-group">
          <input type="search" name="q" placeholder="Search our store" class="search-input" aria-label="Search our store">
          <button type="submit" class="search-submit" aria-label="Submit search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </form>
    </div>
  </div>
</header>

<style>
  /* Header Styles */
  .site-header {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    z-index: var(--z-sticky);
    transition: background-color var(--transition-normal), box-shadow var(--transition-normal);
  }
  
  .site-header.is-sticky {
    background-color: rgba(18, 18, 18, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: var(--shadow-md);
  }
  
  .header-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 80px;
    padding: 0 var(--spacing-lg);
    max-width: 1600px;
    margin: 0 auto;
  }
  
  .header-left, 
  .header-right {
    flex: 1;
    display: flex;
    align-items: center;
  }
  
  .header-right {
    justify-content: flex-end;
  }
  
  /* Logo */
  .header-logo {
    margin: 0 var(--spacing-lg);
  }
  
  .logo-link {
    display: block;
  }
  
  .logo-image {
    max-height: 40px;
    width: auto;
  }
  
  .site-name {
    font-size: var(--font-size-2xl);
    font-weight: bold;
    color: var(--text-color);
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  /* Navigation */
  .header-nav {
    display: flex;
    align-items: center;
  }
  
  .nav-menu {
    display: flex;
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .nav-item {
    position: relative;
    margin: 0 var(--spacing-sm);
  }
  
  .nav-link {
    display: flex;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-md);
    color: var(--text-color);
    text-decoration: none;
    font-weight: 500;
    transition: color var(--transition-fast);
  }
  
  .nav-link:hover,
  .nav-link.active {
    color: var(--accent-color);
  }
  
  .dropdown-arrow {
    margin-left: var(--spacing-xs);
    transition: transform var(--transition-fast);
  }
  
  .nav-item.has-dropdown:hover .dropdown-arrow {
    transform: rotate(180deg);
  }
  
  /* Dropdown Menu */
  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    width: 220px;
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-normal);
    pointer-events: none;
    z-index: var(--z-dropdown);
  }
  
  .nav-item.has-dropdown:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
    pointer-events: auto;
  }
  
  .dropdown-container {
    margin-top: var(--spacing-md);
    background-color: var(--background-light);
    border-radius: var(--radius-md);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
  }
  
  .dropdown-container:before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%) translateY(-50%) rotate(45deg);
    width: 16px;
    height: 16px;
    background-color: var(--background-light);
    z-index: -1;
  }
  
  .dropdown-list {
    list-style: none;
    padding: var(--spacing-md);
    margin: 0;
  }
  
  .dropdown-item {
    margin-bottom: var(--spacing-sm);
  }
  
  .dropdown-item:last-child {
    margin-bottom: 0;
  }
  
  .dropdown-link {
    display: block;
    padding: var(--spacing-sm) var(--spacing-md);
    color: var(--text-color);
    text-decoration: none;
    transition: all var(--transition-fast);
    border-radius: var(--radius-sm);
  }
  
  .dropdown-link:hover,
  .dropdown-link.active {
    background-color: rgba(255, 255, 255, 0.05);
    color: var(--accent-color);
  }
  
  /* Header Actions */
  .header-actions {
    display: flex;
    align-items: center;
  }
  
  .search-toggle,
  .account-link,
  .cart-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    margin-left: var(--spacing-sm);
    color: var(--text-color);
    border: none;
    background: transparent;
    border-radius: var(--radius-full);
    transition: all var(--transition-fast);
  }
  
  .search-toggle:hover,
  .account-link:hover,
  .cart-link:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--accent-color);
  }
  
  .cart-link {
    position: relative;
  }
  
  .cart-count {
    position: absolute;
    top: -5px;
    right: -5px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    background: var(--accent-color);
    color: var(--primary-color);
    font-size: var(--font-size-xs);
    font-weight: bold;
    border-radius: var(--radius-full);
  }
  
  /* Mobile Menu Toggle */
  .mobile-menu-toggle {
    display: none;
    background: transparent;
    border: none;
    width: 40px;
    height: 40px;
    padding: 0;
    cursor: pointer;
  }
  
  .hamburger-icon {
    position: relative;
    display: block;
    width: 24px;
    height: 2px;
    background-color: var(--text-color);
    transition: all var(--transition-fast);
  }
  
  .hamburger-icon:before,
  .hamburger-icon:after {
    content: '';
    position: absolute;
    left: 0;
    width: 24px;
    height: 2px;
    background-color: var(--text-color);
    transition: all var(--transition-fast);
  }
  
  .hamburger-icon:before {
    top: -8px;
  }
  
  .hamburger-icon:after {
    bottom: -8px;
  }
  
  /* Mobile Menu */
  .mobile-menu {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    z-index: var(--z-modal);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-normal);
  }
  
  .mobile-menu[aria-hidden="false"] {
    opacity: 1;
    visibility: visible;
  }
  
  .mobile-menu-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 85%;
    max-width: 350px;
    height: 100%;
    background-color: var(--background-color);
    padding: var(--spacing-lg);
    overflow-y: auto;
    transform: translateX(-100%);
    transition: transform var(--transition-normal);
  }
  
  .mobile-menu[aria-hidden="false"] .mobile-menu-container {
    transform: translateX(0);
  }
  
  .mobile-menu-header {
    display: flex;
    justify-content: flex-end;
    margin-bottom: var(--spacing-lg);
  }
  
  .mobile-menu-close {
    background: transparent;
    border: none;
    color: var(--text-color);
    padding: 0;
  }
  
  .mobile-menu-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .mobile-menu-item {
    margin-bottom: var(--spacing-md);
  }
  
  .mobile-menu-link {
    display: block;
    padding: var(--spacing-sm) 0;
    color: var(--text-color);
    text-decoration: none;
    font-size: var(--font-size-lg);
  }
  
  .mobile-menu-trigger {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: var(--spacing-sm) 0;
    background: transparent;
    border: none;
    color: var(--text-color);
    font-size: var(--font-size-lg);
    text-align: left;
  }
  
  .mobile-menu-arrow {
    transition: transform var(--transition-fast);
  }
  
  .mobile-menu-trigger[aria-expanded="true"] .mobile-menu-arrow {
    transform: rotate(180deg);
  }
  
  .mobile-submenu {
    list-style: none;
    padding: 0 0 0 var(--spacing-lg);
    margin: var(--spacing-sm) 0 0;
    display: none;
  }
  
  .mobile-menu-trigger[aria-expanded="true"] + .mobile-submenu {
    display: block;
  }
  
  .mobile-submenu-item {
    margin-bottom: var(--spacing-sm);
  }
  
  .mobile-submenu-link {
    display: block;
    padding: var(--spacing-xs) 0;
    color: var(--text-muted);
    text-decoration: none;
  }
  
  /* Search Modal */
  .search-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    z-index: var(--z-modal);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-normal);
  }
  
  .search-modal[aria-hidden="false"] {
    opacity: 1;
    visibility: visible;
  }
  
  .search-modal-container {
    width: 100%;
    max-width: 600px;
    padding: var(--spacing-lg);
    transform: translateY(30px);
    transition: transform var(--transition-normal);
  }
  
  .search-modal[aria-hidden="false"] .search-modal-container {
    transform: translateY(0);
  }
  
  .search-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-lg);
  }
  
  .search-modal-title {
    color: var(--text-color);
    margin: 0;
    font-size: var(--font-size-2xl);
  }
  
  .search-modal-close {
    background: transparent;
    border: none;
    color: var(--text-color);
    padding: 0;
  }
  
  .search-input-group {
    position: relative;
    display: flex;
    align-items: center;
  }
  
  .search-input {
    width: 100%;
    height: 60px;
    padding: 0 var(--spacing-lg);
    background-color: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-full);
    color: var(--text-color);
    font-size: var(--font-size-lg);
    transition: all var(--transition-fast);
  }
  
  .search-input:focus {
    border-color: var(--accent-color);
    outline: none;
  }
  
  .search-submit {
    position: absolute;
    right: var(--spacing-md);
    background: transparent;
    border: none;
    color: var(--text-color);
    padding: 0;
  }
  
  /* Responsive Styles */
  @media (max-width: 992px) {
    .header-nav {
      display: none;
    }
    
    .mobile-menu-toggle {
      display: block;
    }
    
    .header-container {
      height: 70px;
    }
  }
  
  @media (max-width: 576px) {
    .header-container {
      padding: 0 var(--spacing-md);
    }
    
    .site-name {
      font-size: var(--font-size-xl);
    }
    
    .logo-image {
      max-height: 30px;
    }
    
    .search-toggle, 
    .account-link, 
    .cart-link {
      width: 36px;
      height: 36px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Sticky Header
    const header = document.querySelector('[data-sticky-header]');
    const headerHeight = header.offsetHeight;
    
    function handleScroll() {
      if (window.scrollY > headerHeight) {
        header.classList.add('is-sticky');
      } else {
        header.classList.remove('is-sticky');
      }
    }
    
    window.addEventListener('scroll', handleScroll);
    
    // Mobile Menu
    const menuToggle = document.querySelector('.mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuClose = document.querySelector('.mobile-menu-close');
    const menuTriggers = document.querySelectorAll('.mobile-menu-trigger');
    
    menuToggle.addEventListener('click', function() {
      const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
      menuToggle.setAttribute('aria-expanded', !isExpanded);
      mobileMenu.setAttribute('aria-hidden', isExpanded);
      document.body.style.overflow = isExpanded ? '' : 'hidden';
    });
    
    menuClose.addEventListener('click', function() {
      menuToggle.setAttribute('aria-expanded', 'false');
      mobileMenu.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    });
    
    menuTriggers.forEach(trigger => {
      trigger.addEventListener('click', function() {
        const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
        trigger.setAttribute('aria-expanded', !isExpanded);
      });
    });
    
    // Search Modal
    const searchToggle = document.querySelector('.search-toggle');
    const searchModal = document.getElementById('search-modal');
    const searchClose = document.querySelector('.search-modal-close');
    
    searchToggle.addEventListener('click', function() {
      const isExpanded = searchToggle.getAttribute('aria-expanded') === 'true';
      searchToggle.setAttribute('aria-expanded', !isExpanded);
      searchModal.setAttribute('aria-hidden', isExpanded);
      
      if (!isExpanded) {
        setTimeout(() => {
          searchModal.querySelector('.search-input').focus();
        }, 300);
      }
      
      document.body.style.overflow = isExpanded ? '' : 'hidden';
    });
    
    searchClose.addEventListener('click', function() {
      searchToggle.setAttribute('aria-expanded', 'false');
      searchModal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    });
    
    // Close modals on click outside
    window.addEventListener('click', function(event) {
      if (event.target === mobileMenu) {
        menuToggle.setAttribute('aria-expanded', 'false');
        mobileMenu.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }
      
      if (event.target === searchModal) {
        searchToggle.setAttribute('aria-expanded', 'false');
        searchModal.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
      }
    });
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    }
  ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %} 